(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{16:function(e,t,n){e.exports=n(40)},39:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),u=n(14),c=n.n(u),l=n(15),o=n(2),s=n.n(o),i=n(1),m=function(e){var t=e.blog,n=e.updateLikes,u=e.deleteBlog,c=e.currentUser,l=Object(a.useState)(!1),o=Object(i.a)(l,2),s=o[0],m=o[1];return r.a.createElement("div",{style:{paddingTop:10,paddingLeft:5,border:"solid",borderWidth:1,marginBottom:5},className:"blog"},r.a.createElement("div",{onClick:function(){return m(!s)},className:"blogName"},t.title," ",t.author),s?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,t.url),r.a.createElement("div",null,t.likes," likes",r.a.createElement("button",{onClick:n},"like")),r.a.createElement("div",null,"added by ",t.user.name),c.username===t.user.username?r.a.createElement("button",{onClick:u},"remove"):null):null)},d=function(e){var t=e.message,n=e.success;return null===t?null:r.a.createElement(r.a.Fragment,null,n?r.a.createElement("div",{className:"successfulOperation"},t):r.a.createElement("div",{className:"unsuccessfulOperation"},t))},f=n(4),p=n.n(f),b=function(e){var t;return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.a.awrap(p.a.post("/api/login",e));case 2:return t=n.sent,n.abrupt("return",t.data);case 4:case"end":return n.stop()}}))},v=function(e){var t=e.onSubmit,n=e.handleTitleChange,a=e.handleAuthorChange,u=e.handleUrlChange,c=e.title,l=e.author,o=e.url;return r.a.createElement("div",null,r.a.createElement("h2",null,"create new"),r.a.createElement("form",{onSubmit:t},r.a.createElement("div",null,"title:",r.a.createElement("input",{type:"text",value:c,name:"Title",onChange:n})),r.a.createElement("div",null,"author:",r.a.createElement("input",{type:"text",value:l,name:"Author",onChange:a})),r.a.createElement("div",null,"url:",r.a.createElement("input",{type:"text",value:o,name:"URL",onChange:u})),r.a.createElement("button",{type:"submit"},"create")))},g=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),u=Object(i.a)(n,2),c=u[0],l=u[1],o={display:c?"none":""},s={display:c?"":"none"},m=function(){l(!c)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:m}})),r.a.createElement("div",null,r.a.createElement("div",{style:o},r.a.createElement("button",{onClick:m},e.buttonLabel)),r.a.createElement("div",{style:s},e.children,r.a.createElement("button",{onClick:m},"cancel")))}));g.displayName="Togglable";var E=g,h=function(e){var t=Object(a.useState)(""),n=Object(i.a)(t,2),r=n[0],u=n[1];return{formInput:{type:e,value:r,onChange:function(e){u(e.target.value)}},reset:function(){u("")}}},O=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),n=t[0],u=t[1],c=Object(a.useState)(""),o=Object(i.a)(c,2),f=o[0],g=o[1],O=Object(a.useState)(""),w=Object(i.a)(O,2),j=w[0],y=w[1],k=Object(a.useState)(""),S=Object(i.a)(k,2),x=S[0],C=S[1],T=Object(a.useState)(null),I=Object(i.a)(T,2),L=I[0],N=I[1],U=Object(a.useState)(null),A=Object(i.a)(U,2),B=A[0],F=A[1],J=h("text"),R=h("text"),z=function(e){var t=Object(a.useState)([]),n=Object(i.a)(t,2),r=n[0],u=n[1],c=Object(a.useState)(""),l=Object(i.a)(c,2),o=l[0],m=l[1];Object(a.useEffect)((function(){!function(){var t;s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.a.awrap(p.a.get(e));case 2:t=n.sent,u(t.data);case 4:case"end":return n.stop()}}))}()}),[e]);var d={create:function(t){var n,a;return s.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n={headers:{Authorization:o}},c.next=3,s.a.awrap(p.a.post(e,t,n));case 3:return a=c.sent,u(r.concat(a.data)),c.abrupt("return",a.data);case 6:case"end":return c.stop()}}))},setTokenState:function(e){m("bearer ".concat(e))},update:function(t){var n;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.awrap(p.a.put("".concat(e,"/").concat(t.id),t));case 2:return n=a.sent,u(r.map((function(e){return e.id!==t.id?e:t}))),a.abrupt("return",n.data);case 5:case"end":return a.stop()}}))},remove:function(t){var n,a;return s.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n={headers:{Authorization:o}},c.next=3,s.a.awrap(p.a.delete("".concat(e,"/").concat(t),n));case 3:return a=c.sent,u(r.filter((function(e){return e.id!==t}))),c.abrupt("return",a.data);case 6:case"end":return c.stop()}}))}};return[r,d]}("/api/blogs"),D=Object(i.a)(z,2),H=D[0],V=D[1];H.sort((function(e,t){return e.likes-t.likes})),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogListUser");if(e){var t=JSON.parse(e);u(t),V.setTokenState(t.token)}}),[]);var W=function(e){var t;return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.preventDefault(),n.prev=1,n.next=4,s.a.awrap(b({username:J.formInput.value,password:R.formInput.value}));case 4:t=n.sent,window.localStorage.setItem("loggedBlogListUser",JSON.stringify(t)),V.setTokenState(t.token),u(t),J.reset(),R.reset(),n.next=17;break;case 12:n.prev=12,n.t0=n.catch(1),N("wrong username or password"),F(!1),setTimeout((function(){N(null),F(null)}),5e3);case 17:case"end":return n.stop()}}),null,null,[[1,12]])},q=function(e){e.preventDefault();var t={title:f,author:j,url:x};V.create(t),N("a new blog ".concat(f," by ").concat(j," added")),F(!0),setTimeout((function(){N(null),F(null)}),5e3),g(""),y(""),C("")},G=function(){window.localStorage.clear(),u(null)},K=function(){return H.map((function(e){return r.a.createElement(m,{key:e.id,blog:e,updateLikes:function(){return function(e){var t=Object(l.a)({},e,{likes:e.likes+1});V.update(t)}(e)},deleteBlog:function(){return function(e,t,n){window.confirm("remove blog ".concat(e," by ").concat(t,"?"))&&V.remove(n)}(e.title,e.author,e.id)},currentUser:n})}))},M=r.a.createRef();return r.a.createElement("div",{className:"App"},null===n?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Log in to application"),r.a.createElement(d,{message:L,success:B}),r.a.createElement("form",{onSubmit:W},r.a.createElement("div",null,"username",r.a.createElement("input",J.formInput)),r.a.createElement("div",null,"password",r.a.createElement("input",R.formInput)),r.a.createElement("button",{type:"submit"},"login"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"blogs"),r.a.createElement(d,{message:L,success:B}),n.name," logged in",r.a.createElement("button",{onClick:G},"logout"),r.a.createElement(E,{buttonLabel:"new note",ref:M},r.a.createElement(v,{onSubmit:q,handleTitleChange:function(e){var t=e.target;return g(t.value)},handleAuthorChange:function(e){var t=e.target;return y(t.value)},handleUrlChange:function(e){var t=e.target;return C(t.value)},title:f,author:j,url:x})),K()))};n(39);c.a.render(r.a.createElement(O,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.53e637e4.chunk.js.map